<button onclick="FB.Connect.showPermissionDialog('publish_stream');">
  Grant publish_stream
</button>
<button onclick="doPublish()">Do Publish</button>

<script>
window.doPublish = function() {
  var message = "message";
  var attachment = {
    name: 'Name',
    href: 'http://example.com/',
    description: 'Lorem Ipsum'
  };
  FB.ensureInit(function() {
    FB.Connect.streamPublish(
      message,
      attachment,
      null, // action_links
      null, // target_id
      'foo', // user_message_prompt
      Log.info.bind('streamPublish callback'),
      true, // auto_publish
      null // actor_id
    );
  });
};
</script>
